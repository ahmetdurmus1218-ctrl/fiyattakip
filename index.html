<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#4f5bd5" />
  <title>FiyatTakip</title>

  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />

  <style>
    :root{
      --p:#4f5bd5; --bg:#f5f6fa; --card:#fff; --muted:#6b7280;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    body{margin:0;background:var(--bg);color:#111827}
    header{position:sticky;top:0;background:#fff;box-shadow:0 2px 18px rgba(0,0,0,.08);z-index:10}
    .bar{max-width:920px;margin:0 auto;padding:12px 14px;display:flex;align-items:center;gap:10px}
    .pill{background:#eef2ff;color:#1f2a7a;padding:6px 12px;border-radius:999px;font-weight:900}
    .spacer{flex:1}
    .btnIcon{width:42px;height:42px;border-radius:14px;border:1px solid #e5e7eb;background:#f9fafb;cursor:pointer;display:flex;align-items:center;justify-content:center}
    .btnIcon.primary{background:#eef2ff;border-color:#c7d2fe}
    .btnIcon svg{width:20px;height:20px}
    main{max-width:920px;margin:0 auto;padding:14px}
    h1{margin:10px 0 6px;font-size:28px}
    .sub{margin:0 0 12px;color:var(--muted)}
    .card{background:var(--card);border-radius:16px;padding:14px;box-shadow:0 10px 25px rgba(0,0,0,.08);margin:14px 0}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    input,select,button{font:inherit;border-radius:14px;border:1px solid #e5e7eb;padding:12px;background:#fff;outline:none}
    input:focus,select:focus{border-color:#c7d2fe;box-shadow:0 0 0 4px rgba(99,102,241,.12)}
    .q{flex:1 1 280px}
    .btn{background:var(--p);color:#fff;border:none;font-weight:900;cursor:pointer;padding:12px 16px;border-radius:16px}
    .btnGhost{background:#eef2ff;color:#1f2a7a;border:1px solid #dbeafe;font-weight:900;cursor:pointer;border-radius:16px}
    .danger{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}
    .ok{background:#dcfce7;color:#166534;border:1px solid #bbf7d0}
    .muted{color:var(--muted);font-size:13px}
    .hr{height:1px;background:#eef2f7;margin:12px 0}
    .chip{padding:8px 10px;border-radius:999px;background:#f3f4f6;border:1px solid #e5e7eb;font-weight:900;font-size:13px;cursor:pointer;user-select:none}
    .chip.active{background:#eef2ff;border-color:#c7d2fe;color:#1f2a7a}
    .item{border:1px solid #eef2f7;border-radius:16px;padding:12px;display:flex;gap:10px;justify-content:space-between;align-items:flex-start}
    .left{min-width:0}
    .title{margin:0 0 6px;font-weight:1000}
    .small{margin:0;color:var(--muted);font-size:13px;word-break:break-word}
    .acts{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
    /* Auth overlay */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;z-index:100;align-items:center;justify-content:center;padding:14px}
    .overlay.open{display:flex}
    .auth{width:min(440px,96vw);background:#fff;border-radius:22px;padding:14px;box-shadow:0 20px 60px rgba(0,0,0,.25)}
    .tabs{display:flex;gap:8px;margin:10px 0}
    .tab{flex:1;border-radius:14px;border:1px solid #e5e7eb;background:#f9fafb;padding:10px 12px;font-weight:900;cursor:pointer}
    .tab.active{background:#eef2ff;border-color:#c7d2fe;color:#1f2a7a}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:720px){.grid2{grid-template-columns:1fr}}
    /* AI sheet */
    .sheetBg{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;z-index:80}
    .sheetBg.open{display:block}
    .sheet{position:absolute;left:0;right:0;bottom:0;background:#fff;border-radius:22px 22px 0 0;padding:14px;max-height:78vh;overflow:auto;box-shadow:0 -18px 45px rgba(0,0,0,.20)}
    .sheetHead{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .note{background:#fff7ed;border:1px solid #fed7aa;color:#7c2d12;padding:10px 12px;border-radius:14px;font-size:13px}
  </style>
</head>

<body>
<header>
  <div class="bar">
    <span class="pill">fiyattakip</span>
    <span class="spacer"></span>

    <button class="btnIcon primary" id="aiBtn" title="AI Arama">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
           stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 2v2"/><path d="M8 4h8"/>
        <rect x="5" y="7" width="14" height="13" rx="3"/>
        <path d="M9 12h.01M15 12h.01"/><path d="M8 16h8"/>
      </svg>
    </button>

    <button class="btnIcon" id="logoutBtn" title="Ã‡Ä±kÄ±ÅŸ">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
           stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
        <path d="M16 17l5-5-5-5"/><path d="M21 12H9"/>
      </svg>
    </button>
  </div>
</header>

<main>
  <h1>Fiyat KarÅŸÄ±laÅŸtÄ±r</h1>
  <p class="sub" id="banner">GiriÅŸ durumu kontrol ediliyorâ€¦</p>

  <!-- SEARCH -->
  <div class="card">
    <div class="row" id="siteList"></div>

    <div class="row" style="margin-top:12px">
      <input class="q" id="q" placeholder="ÃœrÃ¼n adÄ±nÄ± yaz..." />
      <button class="btn" id="searchBtn">Ara</button>
      <button class="btnGhost ok" id="openCheapestAll">En Ucuz AÃ§</button>
      <button class="btnGhost" id="addFavBtn">Favoriye Ekle</button>
    </div>

    <p class="muted" style="margin-top:10px">
      Not: â€œEn ucuz Ã¼rÃ¼n linkini otomatik bulmaâ€ iÅŸi backend gerektirir. Burada seÃ§ili sitede â€œfiyata gÃ¶re sÄ±ralaâ€ parametresi olanlarda aÃ§ar.
    </p>
  </div>

  <!-- RESULTS -->
  <div class="card">
    <div class="row" style="justify-content:space-between">
      <div>
        <div style="font-weight:1000">Arama</div>
        <div class="muted">SeÃ§ili sitelerde arama aÃ§ar.</div>
      </div>
      <button class="btnGhost" id="clearResultsBtn">Temizle</button>
    </div>
    <div class="hr"></div>
    <div id="results"></div>
  </div>

  <!-- FAVORITES -->
  <div class="card">
    <div class="row" style="justify-content:space-between">
      <div>
        <div style="font-weight:1000">â¤ï¸ Favoriler (kullanÄ±cÄ±ya Ã¶zel)</div>
        <div class="muted">Linkler gÃ¶rÃ¼nmez; butonla aÃ§ / copy ile kopyala.</div>
      </div>
      <button class="btnGhost danger" id="clearFavBtn">Hepsini Sil</button>
    </div>
    <div class="hr"></div>
    <div id="favorites"></div>
  </div>

  <!-- ALERTS -->
  <div class="card">
    <div style="font-weight:1000">ğŸ”” Ä°ndirim UyarÄ±larÄ± (kullanÄ±cÄ±ya Ã¶zel)</div>
    <p class="muted">
      Åimdilik fiyatÄ± sen gÃ¼ncellersin â†’ geÃ§miÅŸ oluÅŸur. Kural: <b>%5 altÄ± sayma</b>, <b>%5+ olursa bildir</b>.
      AyrÄ±ca <b>6 ayÄ±n en dÃ¼ÅŸÃ¼ÄŸÃ¼yse</b> â€œ6 ayÄ±n en dÃ¼ÅŸÃ¼ÄŸÃ¼â€ diye yazar.
    </p>

    <div class="grid2">
      <input id="alertTitle" placeholder="ÃœrÃ¼n adÄ±" />
      <input id="alertUrl" placeholder="Takip linki" />
      <input id="alertCurrent" inputmode="decimal" placeholder="Åu anki fiyat (Ã¶rn: 12999)" />
      <input id="alertMinPct" inputmode="decimal" placeholder="Minimum indirim % (Ã¶rn: 5)" />
    </div>

    <div class="row" style="margin-top:10px">
      <button class="btn" id="addAlertBtn">UyarÄ± Ekle</button>
      <button class="btnGhost" id="notifBtn">Bildirim Ä°zni</button>
      <button class="btnGhost" id="checkBtn">Kontrol</button>
    </div>

    <div class="hr"></div>
    <div id="alerts"></div>
  </div>
</main>

<!-- AI SHEET -->
<div class="sheetBg" id="aiSheet">
  <div class="sheet">
    <div class="sheetHead">
      <div style="font-weight:1000;font-size:18px">ğŸ¤– AI Arama</div>
      <button class="btnIcon" id="aiClose" title="Kapat">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
             stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
    </div>
    <div class="hr"></div>

    <div class="grid2">
      <select id="aiProvider">
        <option value="gemini">Gemini</option>
        <option value="openai">OpenAI (backend Ã¶nerilir)</option>
      </select>
      <input id="aiKey" placeholder="AI API Key (Gemini Ã¶nerilir)" />
    </div>

    <div class="row" style="margin-top:10px">
      <button class="btnGhost" id="saveAiKey">Key Kaydet</button>
      <button class="btnGhost" id="fillExample">Ã–rnek Doldur</button>
    </div>

    <div class="hr"></div>
    <input id="aiPrompt" placeholder="AIâ€™ye sor: (Ã¶rn: Xiaomi Pad 7 256GB tablet en ucuz?)" />
    <div class="row" style="margin-top:10px">
      <button class="btnGhost" id="aiFill">AI ile AramayÄ± Doldur</button>
      <button class="btn" id="aiSearch">AI ile Ara</button>
    </div>

    <p class="muted" id="aiStatus" style="margin-top:10px"></p>
    <div class="note" style="margin-top:10px">
      Not: OpenAI keyâ€™i tarayÄ±cÄ±da kullanmak riskli. Åimdilik Gemini ile Ã§alÄ±ÅŸtÄ±r.
    </div>
  </div>
</div>

<!-- AUTH -->
<div class="overlay" id="authOverlay">
  <div class="auth">
    <div style="font-weight:1000;font-size:18px" id="authTitle">GiriÅŸ</div>
    <div class="tabs">
      <button class="tab active" id="tabLogin">GiriÅŸ</button>
      <button class="tab" id="tabReg">KayÄ±t</button>
      <button class="tab" id="tabVer">DoÄŸrula</button>
    </div>

    <div id="paneLogin">
      <div class="grid2">
        <input id="loginEmail" placeholder="Email" autocomplete="email" />
        <input id="loginPass" placeholder="Åifre" type="password" autocomplete="current-password" />
      </div>
      <div class="row" style="margin-top:10px">
        <button class="btn" id="loginGo">GiriÅŸ Yap</button>
        <button class="btnGhost" id="resetGo">Åifre SÄ±fÄ±rla</button>
      </div>
      <p class="muted" style="margin-top:10px">Favori/UyarÄ± iÃ§in giriÅŸ ve email doÄŸrulamasÄ± ÅŸart.</p>
    </div>

    <div id="paneReg" style="display:none">
      <div class="grid2">
        <input id="regEmail" placeholder="Email" autocomplete="email" />
        <input id="regPass" placeholder="Åifre (min 6)" type="password" autocomplete="new-password" />
      </div>
      <div class="row" style="margin-top:10px">
        <button class="btn" id="regGo">KayÄ±t Ol</button>
      </div>
      <p class="muted" style="margin-top:10px">KayÄ±ttan sonra doÄŸrulama maili gider.</p>
    </div>

    <div id="paneVer" style="display:none">
      <div class="note">
        Email doÄŸrulama olmadan uygulama aÃ§Ä±lmaz. Maili aÃ§Ä±p doÄŸruladÄ±ktan sonra â€œKontrol Etâ€ de.
      </div>
      <div class="row" style="margin-top:10px">
        <button class="btn" id="resendGo">Maili Tekrar GÃ¶nder</button>
        <button class="btnGhost" id="checkVerGo">Kontrol Et</button>
      </div>
    </div>

    <div class="hr"></div>
    <p class="muted" id="authMsg"></p>
  </div>
</div>

<script type="module" src="app.js"></script>
</body>
</html>
